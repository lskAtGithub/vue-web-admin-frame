import{C as B}from"./Container-68c6570c.js";import{O as W,Q as O,d as U,a as S,R as N,r as V,o as G,H as J,b as R,c as P,j as T,g as w,f as E,u as F,G as H,J as $,E as x,p as q,h as D,_ as K,e as Q,w as X}from"./index-c69f23bb.js";var j={exports:{}};(function(v,b){(function(g,m){v.exports=m()})(W,function(){function g(e){var d=[];return e.AMapUI&&d.push(m(e.AMapUI)),e.Loca&&d.push(h(e.Loca)),Promise.all(d)}function m(e){return new Promise(function(d,i){var p=[];if(e.plugins)for(var o=0;o<e.plugins.length;o+=1)a.AMapUI.plugins.indexOf(e.plugins[o])==-1&&p.push(e.plugins[o]);if(n.AMapUI===t.failed)i("前次请求 AMapUI 失败");else if(n.AMapUI===t.notload){n.AMapUI=t.loading,a.AMapUI.version=e.version||a.AMapUI.version,o=a.AMapUI.version;var u=document.body||document.head,l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/ui/"+o+"/main.js",l.onerror=function(s){n.AMapUI=t.failed,i("请求 AMapUI 失败")},l.onload=function(){if(n.AMapUI=t.loaded,p.length)window.AMapUI.loadUI(p,function(){for(var s=0,c=p.length;s<c;s++){var A=p[s].split("/").slice(-1)[0];window.AMapUI[A]=arguments[s]}for(d();f.AMapUI.length;)f.AMapUI.splice(0,1)[0]()});else for(d();f.AMapUI.length;)f.AMapUI.splice(0,1)[0]()},u.appendChild(l)}else n.AMapUI===t.loaded?e.version&&e.version!==a.AMapUI.version?i("不允许多个版本 AMapUI 混用"):p.length?window.AMapUI.loadUI(p,function(){for(var s=0,c=p.length;s<c;s++){var A=p[s].split("/").slice(-1)[0];window.AMapUI[A]=arguments[s]}d()}):d():e.version&&e.version!==a.AMapUI.version?i("不允许多个版本 AMapUI 混用"):f.AMapUI.push(function(s){s?i(s):p.length?window.AMapUI.loadUI(p,function(){for(var c=0,A=p.length;c<A;c++){var M=p[c].split("/").slice(-1)[0];window.AMapUI[M]=arguments[c]}d()}):d()})})}function h(e){return new Promise(function(d,i){if(n.Loca===t.failed)i("前次请求 Loca 失败");else if(n.Loca===t.notload){n.Loca=t.loading,a.Loca.version=e.version||a.Loca.version;var p=a.Loca.version,o=a.AMap.version.startsWith("2"),u=p.startsWith("2");if(o&&!u||!o&&u)i("JSAPI 与 Loca 版本不对应！！");else{o=a.key,u=document.body||document.head;var l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/loca?v="+p+"&key="+o,l.onerror=function(s){n.Loca=t.failed,i("请求 AMapUI 失败")},l.onload=function(){for(n.Loca=t.loaded,d();f.Loca.length;)f.Loca.splice(0,1)[0]()},u.appendChild(l)}}else n.Loca===t.loaded?e.version&&e.version!==a.Loca.version?i("不允许多个版本 Loca 混用"):d():e.version&&e.version!==a.Loca.version?i("不允许多个版本 Loca 混用"):f.Loca.push(function(s){s?i(s):i()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var t;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(t||(t={}));var a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},n={AMap:t.notload,AMapUI:t.notload,Loca:t.notload},f={AMap:[],AMapUI:[],Loca:[]},r=[],_=function(e){typeof e=="function"&&(n.AMap===t.loaded?e(window.AMap):r.push(e))};return{load:function(e){return new Promise(function(d,i){if(n.AMap==t.failed)i("");else if(n.AMap==t.notload){var p=e.key,o=e.version,u=e.plugins;p?(window.AMap&&location.host!=="lbs.amap.com"&&i("禁止多种API加载方式混用"),a.key=p,a.AMap.version=o||a.AMap.version,a.AMap.plugins=u||a.AMap.plugins,n.AMap=t.loading,o=document.body||document.head,window.___onAPILoaded=function(s){if(delete window.___onAPILoaded,s)n.AMap=t.failed,i(s);else for(n.AMap=t.loaded,g(e).then(function(){d(window.AMap)}).catch(i);r.length;)r.splice(0,1)[0]()},u=document.createElement("script"),u.type="text/javascript",u.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+a.AMap.version+"&key="+p+"&plugin="+a.AMap.plugins.join(","),u.onerror=function(s){n.AMap=t.failed,i(s)},o.appendChild(u)):i("请填写key")}else if(n.AMap==t.loaded)if(e.key&&e.key!==a.key)i("多个不一致的 key");else if(e.version&&e.version!==a.AMap.version)i("不允许多个版本 JSAPI 混用");else{if(p=[],e.plugins)for(o=0;o<e.plugins.length;o+=1)a.AMap.plugins.indexOf(e.plugins[o])==-1&&p.push(e.plugins[o]);p.length?window.AMap.plugin(p,function(){g(e).then(function(){d(window.AMap)}).catch(i)}):g(e).then(function(){d(window.AMap)}).catch(i)}else if(e.key&&e.key!==a.key)i("多个不一致的 key");else if(e.version&&e.version!==a.AMap.version)i("不允许多个版本 JSAPI 混用");else{var l=[];if(e.plugins)for(o=0;o<e.plugins.length;o+=1)a.AMap.plugins.indexOf(e.plugins[o])==-1&&l.push(e.plugins[o]);_(function(){l.length?window.AMap.plugin(l,function(){g(e).then(function(){d(window.AMap)}).catch(i)}):g(e).then(function(){d(window.AMap)}).catch(i)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,a={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},n={AMap:t.notload,AMapUI:t.notload,Loca:t.notload},f={AMap:[],AMapUI:[],Loca:[]}}}})})(j);var Y=j.exports;const Z=O(Y),ee=v=>(q("data-v-058932ee"),v=v(),D(),v),oe={class:"search-box"},ne=ee(()=>w("div",{id:"outputId",class:"output-container"},null,-1)),te={class:"map-container"},ae=U({name:"AMapComponents"}),ie=U({...ae,props:{width:{type:String,default:()=>"100%"},height:{type:String,default:()=>"400px"},longitude:{type:[String,Number],default:()=>"116.396938"},latitude:{type:[String,Number],default:()=>"39.909321"},option:{type:Object,default:()=>({zoom:13,resizeEnable:!0})}},emits:["mapSelection","setAddress"],setup(v,{expose:b,emit:g}){const m=v,h=["AMap.Marker","AMap.ToolBar","AMap.AutoComplete","AMap.PlaceSearch","AMap.Geocoder"];let t=null,a=S(""),n=N(null);const f=S(null),r=V({mapMarker:null,geoCoder:null,placeSearch:null}),_=o=>{i(),g("setAddress",o)},e=()=>{const o=[Number(m.longitude),Number(m.latitude)];Z.load({key:"7d99e2e1715e6487c5f1653a2947cdc9",version:"2.0",plugins:h}).then(u=>{t=u,n.value=new u.Map("mapContainer",{center:o,zoom:m.option.zoom,resizeEnable:m.option.resizeEnable}),u.plugin(h,function(){const l=new u.ToolBar({position:{top:"110px",right:"40px"}});n.value.addControl(l),r.mapMarker=new u.Marker({position:o}),n.value.addControl(r.mapMarker);const s=new u.AutoComplete({input:"inputId",output:"outputId"});r.placeSearch=new u.PlaceSearch({map:n.value,autoFitView:!0,pageSize:5,pageIndex:1}),r.geoCoder=new u.Geocoder({radius:1e3,extensions:"all"}),u.Event.addListener(s,"select",c=>{r.placeSearch.search(c.poi.name,(A,M)=>{var L;if(A){const y=(L=M==null?void 0:M.poiList)==null?void 0:L.pois.filter(I=>I.name===c.poi.name)[0];if(y){const I=[y.location.lng,y.location.lat];r.geoCoder.getAddress(I,function(z,k){if(z==="complete"&&k.info==="OK"){const C=Object.assign(k.regeocode,{location:I});r.placeSearch.search(C.formattedAddress),d(C)}else x.error("选择地址出错, 请重试")})}else x.error("未选择到具体的地址或未搜到地址信息"),n.value.clearMap()}else x.error("请求有误， 请刷新重试")})})}),n.value.on("click",function(l){const s=l.lnglat.getLng(),c=l.lnglat.getLat();p([s,c])})})},d=o=>{n.value.clearMap(),r.mapMarker=null,n.value.panTo(o.location),r.mapMarker=new t.Marker({position:o.location}),n.value.addControl(r.mapMarker);const u=`
    <div style="background: #fff;border-radius: 3px;width: 260px; font-size: 13px;padding-bottom: 20px;position: relative;box-shadow: 0 0 5px 0 #ccc;">
      <div style="border-bottom: 1px solid #ccc;padding: 7px 16px;display:flex;justify-content: space-between;align-items:center;">
        <span style="font-size: 15px;">当前位置</span>
        <img id="closeWindow" style="cursor: pointer;" src="https://webapi.amap.com/images/close2.gif" />
      </div>
      <div style="padding: 16px 8px; color: #666;">
        地址：${o.formattedAddress}
      </div>
      <div id="setAddress" style="user-select: none;width: 120px; margin: 0 auto; text-align: center;color: #fff;background: #027db4;padding: 6px 0;cursor: pointer;border-radius: 3px;">
        使用该地址
      </div>
      <div style="position: absolute; left: 115px; bottom: -26px;">
        <svg t="1689070613682" class="icon" viewBox="0 0 1369 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1507" width="20" height="40"><path d="M684.840764 1024L1369.681529 0H0z" p-id="1508" fill="#ffffff"></path></svg>
      </div>
    </div>
  `;new t.InfoWindow({content:u,isCustom:!0,offset:new t.Pixel(5,-45)}).open(n.value,r.mapMarker.getPosition()),document.getElementById("closeWindow").onclick=i,document.getElementById("setAddress").onclick=()=>_(o)},i=()=>{n.value.clearInfoWindow()},p=o=>{n.value.panTo(o);const u=new t.LngLat(o[0],o[1]);r.mapMarker.setPosition(u),r.geoCoder.getAddress(o,function(l,s){const c={...s.regeocode,location:o};d(c),g("mapSelection",c)})};return G(()=>{e()}),J(()=>{n&&n.value.destroy()}),b({initAMap:e}),(o,u)=>{const l=R("el-input");return P(),T("div",null,[w("div",oe,[E(l,{class:"ipt",id:"inputId",modelValue:F(a),"onUpdate:modelValue":u[0]||(u[0]=s=>H(a)?a.value=s:a=s),placeholder:"请输入具体位置"},null,8,["modelValue"]),ne]),w("div",te,[w("div",{ref_key:"mapRef",ref:f,id:"mapContainer",class:"map-element",style:$({width:m.width,height:m.height})},null,4)])])}}});const se=K(ie,[["__scopeId","data-v-058932ee"]]),ue=w("h1",null,"高德地图示例",-1),de=U({__name:"GeoMap",setup(v){return(b,g)=>(P(),Q(B,null,{default:X(()=>[ue,E(se)]),_:1}))}});export{de as default};
